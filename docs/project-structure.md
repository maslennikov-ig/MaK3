# Структура проекта MaK 3 CRM

> **Рекомендации:**
> - Всегда сначала ищем готовую, поддерживаемую библиотеку или компонент, а не пишем с нуля.
> - Предпочитаем использовать самые новые, но стабильные версии библиотек, компонентов и модулей.
> - Если возникает проблема с зависимостями, и нет возможности обновить до последних стабильных версий — отказываемся от проблемного модуля и ищем современную альтернативу, а не фиксируем старую зависимость.
> - Для фронтенда используйте разделение компонентов на презентационные и контейнерные, а также хуки для повторно используемой логики.
> - Для бэкенда придерживайтесь принципов SOLID и выделяйте отдельные модули под каждую функциональную область.

## Введение

Данный документ описывает структуру проекта MaK 3 CRM, включая организацию файлов и директорий как для frontend (Next.js), так и для backend (NestJS). Структура спроектирована с учетом модульности, масштабируемости и удобства разработки.

## Варианты организации структуры проекта

### 1. Feature-based структура

В feature-based структуре код организован по функциональным возможностям (фичам) приложения. Каждая фича содержит все необходимые компоненты, сервисы и модели.

**Преимущества:**
- Логически связанный код находится рядом
- Удобно работать над конкретной функциональностью
- Легче понять, как работает определенная фича

**Недостатки:**
- Возможно дублирование кода между фичами
- Сложнее найти общие компоненты

### 2. Domain-based структура

В domain-based структуре код организован по доменным областям бизнеса. Каждая доменная область содержит свои модели, сервисы и компоненты.

**Преимущества:**
- Хорошо соответствует бизнес-логике
- Удобно для больших проектов с четкими доменными границами
- Способствует соблюдению принципов DDD (Domain-Driven Design)

**Недостатки:**
- Может быть сложно определить границы доменов
- Требует хорошего понимания бизнес-процессов

## Рекомендуемая структура для MaK 3 CRM

Для проекта MaK 3 CRM рекомендуется использовать **гибридный подход**, сочетающий элементы feature-based и domain-based структур:

### Frontend (Next.js с App Router)

```
frontend/
├── app/                       # App Router структура
│   ├── (auth)/                # Группа маршрутов аутентификации
│   │   ├── login/             # Страница входа
│   │   │   └── page.tsx       # Компонент страницы
│   │   ├── register/          # Страница регистрации
│   │   │   └── page.tsx       # Компонент страницы
│   │   └── layout.tsx         # Общий layout для auth страниц
│   ├── (dashboard)/           # Группа маршрутов дашборда (защищенная)
│   │   ├── clients/           # Раздел клиентов
│   │   │   ├── [id]/          # Динамический маршрут для клиента
│   │   │   │   └── page.tsx   # Страница клиента
│   │   │   └── page.tsx       # Список клиентов
│   │   ├── deals/             # Раздел сделок
│   │   │   ├── [id]/          # Динамический маршрут для сделки
│   │   │   │   └── page.tsx   # Страница сделки
│   │   │   └── page.tsx       # Список сделок
│   │   ├── analytics/         # Раздел аналитики
│   │   │   └── page.tsx       # Страница аналитики
│   │   ├── settings/          # Раздел настроек
│   │   │   └── page.tsx       # Страница настроек
│   │   └── layout.tsx         # Общий layout для dashboard
│   ├── api/                   # API Routes
│   │   └── [...]/             # API эндпоинты
│   ├── layout.tsx             # Корневой layout
│   └── page.tsx               # Главная страница
├── components/                # Общие компоненты
│   ├── ui/                    # UI компоненты (кнопки, инпуты и т.д.)
│   ├── forms/                 # Компоненты форм
│   │   ├── LoginForm.tsx      # Форма входа
│   │   └── RegisterForm.tsx   # Форма регистрации
│   ├── layouts/               # Компоненты макетов
│   │   ├── Sidebar.tsx        # Боковая панель
│   │   └── Header.tsx         # Верхняя панель
│   ├── clients/               # Компоненты для работы с клиентами
│   │   ├── ClientCard.tsx     # Карточка клиента
│   │   └── ClientsTable.tsx   # Таблица клиентов
│   └── deals/                 # Компоненты для работы с сделками
│       ├── DealCard.tsx       # Карточка сделки
│       └── KanbanBoard.tsx    # Канбан-доска для сделок
├── lib/                       # Утилиты и хелперы
│   ├── api.ts                 # Функции для работы с API
│   ├── auth.ts                # Утилиты для аутентификации
│   └── utils.ts               # Общие утилиты
├── hooks/                     # Пользовательские хуки
│   ├── useAuth.ts             # Хук для работы с аутентификацией
│   └── useClients.ts          # Хук для работы с клиентами
├── store/                     # Управление состоянием
│   ├── auth/                  # Состояние аутентификации
│   └── clients/               # Состояние клиентов
├── types/                     # TypeScript типы и интерфейсы
│   ├── auth.ts                # Типы для аутентификации
│   └── clients.ts             # Типы для клиентов
└── public/                    # Статические файлы
```

### Backend (NestJS)

```
backend/
├── src/
│   ├── main.ts                # Точка входа
│   ├── app.module.ts          # Корневой модуль
│   ├── prisma/                # Prisma ORM
│   │   ├── prisma.module.ts   # Модуль Prisma
│   │   └── prisma.service.ts  # Сервис Prisma
│   ├── modules/               # Модули приложения
│   │   ├── auth/              # Модуль аутентификации
│   │   │   ├── auth.module.ts # Модуль
│   │   │   ├── auth.controller.ts # Контроллер
│   │   │   ├── auth.service.ts # Сервис
│   │   │   ├── dto/           # Data Transfer Objects
│   │   │   ├── guards/        # Guards
│   │   │   └── strategies/    # Стратегии аутентификации
│   │   ├── users/             # Модуль пользователей
│   │   │   ├── users.module.ts # Модуль
│   │   │   ├── users.controller.ts # Контроллер
│   │   │   ├── users.service.ts # Сервис
│   │   │   └── dto/           # Data Transfer Objects
│   │   ├── clients/           # Модуль клиентов
│   │   │   ├── clients.module.ts # Модуль
│   │   │   ├── clients.controller.ts # Контроллер
│   │   │   ├── clients.service.ts # Сервис
│   │   │   └── dto/           # Data Transfer Objects
│   │   ├── deals/             # Модуль сделок
│   │   │   ├── deals.module.ts # Модуль
│   │   │   ├── deals.controller.ts # Контроллер
│   │   │   ├── deals.service.ts # Сервис
│   │   │   └── dto/           # Data Transfer Objects
│   │   └── components/        # Модуль компонентов (для каталога)
│   │       ├── components.module.ts # Модуль
│   │       ├── components.controller.ts # Контроллер
│   │       ├── components.service.ts # Сервис
│   │       └── dto/           # Data Transfer Objects
│   ├── common/                # Общие утилиты
│   │   ├── decorators/        # Декораторы
│   │   ├── filters/           # Фильтры исключений
│   │   ├── guards/            # Guards для защиты маршрутов
│   │   ├── interceptors/      # Перехватчики
│   │   └── pipes/             # Pipes для валидации
│   ├── config/                # Конфигурация
│   │   └── configuration.ts   # Конфигурация приложения
│   └── jobs/                  # Фоновые задачи
│       ├── jobs.module.ts     # Модуль задач
│       └── processors/        # Обработчики задач
└── prisma/                    # Схема Prisma
    ├── schema.prisma          # Схема базы данных
    └── migrations/            # Миграции
```

## Обоснование выбора структуры

1. **Модульность и масштабируемость**:
   - Разделение на модули позволяет легко добавлять новую функциональность
   - Четкая структура упрощает навигацию по проекту

2. **Соответствие архитектурным принципам**:
   - Frontend: App Router в Next.js обеспечивает интуитивную навигацию
   - Backend: Модульная структура NestJS соответствует принципам DDD

3. **Удобство разработки**:
   - Связанные компоненты и логика находятся рядом
   - Общие компоненты и утилиты легко найти

4. **Поддержка каталога компонентов**:
   - Отдельный модуль для компонентов на бэкенде
   - Структура frontend позволяет легко интегрировать динамические компоненты

## Рекомендации по именованию

1. **Файлы**:
   - Используйте kebab-case для имен файлов: `client-card.tsx`, `auth.service.ts`
   - Добавляйте суффиксы для обозначения типа файла: `.service.ts`, `.controller.ts`, `.module.ts`

2. **Компоненты и классы**:
   - Используйте PascalCase для имен компонентов и классов: `ClientCard`, `AuthService`

3. **Переменные и функции**:
   - Используйте camelCase для имен переменных и функций: `getClient`, `userData`

4. **Константы**:
   - Используйте UPPER_SNAKE_CASE для констант: `API_URL`, `MAX_ITEMS_PER_PAGE`

5. **Интерфейсы и типы**:
   - Используйте PascalCase с префиксом I для интерфейсов: `IUser`, `IClientData`
   - Используйте PascalCase для типов: `UserRole`, `ClientStatus`
